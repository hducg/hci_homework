:root {
  --bg: #f3f6fc;
  --bg-card: #ffffff;
  --primary: #2b9af3;
  --primary-dark: #1f7bc5;
  --text: #1f2937;
  --muted: #6b7280;
  --border: #d1d5db;
  --shadow: 0 12px 24px rgba(18, 73, 135, 0.08);
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: 'Inter', 'PingFang SC', 'Microsoft YaHei', sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
}

h1 { margin: 0; font-size: 1.8rem; font-weight: 600; }
.h2-title { margin-top: 0; font-size: 1.2rem; }

button {
  cursor: pointer;
  border: none;
  border-radius: 10px;
  padding: 10px 16px;
  font-size: 0.95rem;
  background: var(--primary);
  color: #fff;
  transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
}
button:hover, button:focus {
  outline: none;
  background: var(--primary-dark);
  box-shadow: 0 8px 18px rgba(43, 154, 243, 0.28);
  transform: translateY(-1px);
}
button:disabled { background: #9ca3af; cursor: not-allowed; box-shadow: none; }
.secondary-btn { background: #e8f3ff; color: var(--primary); }
.secondary-btn:hover, .secondary-btn:focus { background: #d9ecff; color: var(--primary-dark); box-shadow: none; transform: none; }

input, select, textarea {
  width: 100%; padding: 10px 12px; border: 1px solid var(--border); border-radius: 10px; font-size: 0.95rem; background: #fff; transition: border-color 0.2s ease, box-shadow 0.2s ease;
}
input:focus, select:focus, textarea:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(43, 154, 243, 0.15); outline: none; }
label { display: block; font-weight: 600; margin-bottom: 6px; color: var(--muted); }

.diary-shell { min-height: 100vh; display: flex; flex-direction: column; }
.topbar { position: sticky; top: 0; z-index: 20; background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); box-shadow: 0 1px 0 rgba(209,213,219,0.6); padding: 14px 28px; display: flex; align-items: center; gap: 18px; }
.topbar-controls { display: flex; gap: 10px; flex-wrap: wrap; }
main { flex: 1; padding: 28px; }

.diary-app { display: grid; grid-template-columns: 340px minmax(0,1fr); gap: 24px; }
.card { background: var(--bg-card); border-radius: 20px; padding: 22px; box-shadow: var(--shadow); }
.card + .card { margin-top: 18px; }

.metadata-grid { display: grid; gap: 16px; }
.metadata-grid .inline { display: grid; gap: 10px; grid-template-columns: repeat(2, minmax(0,1fr)); }
.badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 999px; background: #eff6ff; color: var(--primary); font-size: 0.85rem; margin-top: 4px; }
.badge span { font-size: 1rem; }

.editor-shell { display: flex; flex-direction: column; gap: 18px; }
.toolbar { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
.toolbar button { padding: 8px 12px; font-size: 0.9rem; }

#diary-content { min-height: 320px; border: 2px dashed transparent; border-radius: 16px; background: linear-gradient(135deg, rgba(231,238,255,0.4), rgba(255,255,255,0.9)); padding: 20px; outline: none; overflow-wrap: break-word; }
#diary-content:focus { border-color: rgba(43,154,243,0.5); background: rgba(255,255,255,0.9); box-shadow: inset 0 0 0 1px rgba(43,154,243,0.2); }
#diary-content img, #diary-content audio, #diary-content canvas { max-width: 100%; border-radius: 14px; margin: 12px 0; box-shadow: 0 12px 24px rgba(15,23,42,0.12); }
#diary-content p { margin: 0 0 12px; line-height: 1.8; font-size: 1rem; }

.dropzone { position: relative; border: 2px dashed rgba(43,154,243,0.5); border-radius: 16px; padding: 20px; text-align: center; color: var(--muted); transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease; cursor: pointer; }
.dropzone.dragover { background: rgba(43,154,243,0.08); color: var(--primary); border-color: var(--primary); }

.emoji-panel-wrapper { position: relative; }
.emoji-panel { position: absolute; top: calc(100% + 8px); left: 0; z-index: 50; width: 260px; max-height: 260px; overflow-y: auto; background: #fff; border-radius: 16px; box-shadow: 0 20px 40px rgba(15,23,42,0.18); padding: 16px; display: none; flex-direction: column; gap: 12px; }
.emoji-panel.open { display: flex; }
.emoji-search input { border-radius: 999px; padding: 8px 14px; font-size: 0.9rem; }
.emoji-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; }
.emoji-btn { background: transparent; border: none; font-size: 1.4rem; padding: 6px; border-radius: 10px; transition: background 0.2s ease; }
.emoji-btn:hover, .emoji-btn:focus { background: rgba(43,154,243,0.18); }

canvas { width: 100%; height: auto; display: block; border-radius: 16px; border: 2px solid rgba(43,154,243,0.2); background: #fff; cursor: crosshair; box-shadow: inset 0 0 0 1px rgba(43,154,243,0.05); }
.canvas-wrapper { width: 100%; position: relative; }
#canvas-bounds-overlay { box-sizing: border-box; position: absolute; pointer-events: none; border: 2px dashed rgba(43,154,243,0.8); border-radius: 8px; display: none; }

.canvas-controls { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; margin-top: 12px; }
.canvas-controls label { margin-bottom: 0; font-size: 0.9rem; }

.audio-controls { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 12px; align-items: center; }
.audio-status { font-size: 0.9rem; color: var(--muted); }

.attachments-preview { display: flex; flex-wrap: wrap; gap: 12px; margin-top: 16px; }
.attachments-preview img, .attachments-preview audio { max-width: 180px; border-radius: 14px; box-shadow: 0 10px 20px rgba(15,23,42,0.12); }

.status-bar { display: flex; flex-direction: column; gap: 6px; font-size: 0.9rem; color: var(--muted); }
.status-bar strong { color: var(--primary-dark); }

.floating-save { position: fixed; bottom: 24px; right: 24px; z-index: 40; box-shadow: 0 16px 32px rgba(43,154,243,0.4); border-radius: 999px; padding: 14px 24px; font-weight: 600; }

/* editor attachments */
.attachment { position: relative; display: inline-block; margin: 8px 6px; }
.attachment img, .attachment audio { display: block; max-width: 320px; border-radius: 12px; }
.attachment .remove-btn { position: absolute; top: 6px; right: 6px; background: rgba(0,0,0,0.6); color: #fff; border-radius: 999px; width: 28px; height: 28px; display: inline-flex; align-items: center; justify-content: center; font-size: 14px; border: none; cursor: pointer; }

/* utilities */
#diary-content.is-placeholder { color: #9ca3af; }
.row { display: flex; gap: 8px; align-items: center; }
.nowrap { white-space: nowrap; }
.inline-btn { display: inline-flex; align-items: center; gap: 8px; }

@media (max-width: 1100px) {
  .diary-app { grid-template-columns: 1fr; }
  .topbar { flex-direction: column; align-items: flex-start; gap: 12px; }
}
@media (max-width: 640px) {
  main { padding: 18px; }
  .topbar { padding: 18px; }
  button { width: 100%; }
  .toolbar { flex-direction: column; align-items: stretch; }
  .emoji-panel { left: auto; right: 0; }
  /* keep aspect by width via intrinsic size */
  .floating-save { right: 16px; left: 16px; width: calc(100% - 32px); text-align: center; }
}
