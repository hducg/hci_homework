<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>å¤šåª’ä½“æ—¥è®° Â· å‡çº§ç‰ˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/* ---------- ç¾åŒ–å¼€å§‹ ---------- */
:root{
  --grad-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --panel-bg: rgba(255,255,255,.75);
  --radius: 12px;
  --shadow: 0 8px 32px rgba(0,0,0,.15);
  --trans: .3s ease;
}
body{
  margin: 0;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  background: var(--grad-bg) fixed;
  display: flex;
  min-height: 100vh;
  color: #333;
}
/* å·¦ä¾§ä¿¡æ¯é¢æ¿ */
.info-panel{
  width: 260px;
  background: var(--panel-bg);
  backdrop-filter: blur(10px);
  border-radius: 0 var(--radius) var(--radius) 0;
  box-shadow: var(--shadow);
  padding: 24px 20px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  gap: 18px;
}
.info-panel h2{
  margin: 0 0 10px;
  font-size: 22px;
  text-align: center;
  letter-spacing: 1px;
}
.form-group{
  display: flex;
  flex-direction: column;
}
.form-group label{
  font-size: 14px;
  margin-bottom: 6px;
  font-weight: 600;
}
.form-group input,
.form-group select{
  padding: 8px 10px;
  border: none;
  border-radius: 8px;
  background: rgba(255,255,255,.9);
  box-shadow: 0 2px 4px rgba(0,0,0,.05);
  transition: var(--trans);
}
.form-group input:focus,
.form-group select:focus{
  outline: none;
  box-shadow: 0 0 0 3px rgba(102,126,234,.35);
}

/* å³ä¾§ç¼–è¾‘åŒº */
.editor-wrap{
  flex: 1;
  padding: 30px 40px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}
#diary-content{
  min-height: 220px;
  padding: 15px;
  border-radius: var(--radius);
  background: #fff;
  box-shadow: var(--shadow);
  font-size: 16px;
  line-height: 1.6;
  overflow-y: auto;
}
.toolbar{
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}
.toolbar button,
.toolbar input[type=file]::file-selector-button{
  padding: 8px 14px;
  border: none;
  border-radius: 8px;
  background: #667eea;
  color: #fff;
  font-size: 14px;
  cursor: pointer;
  transition: var(--trans);
}
.toolbar button:hover,
.toolbar input[type=file]::file-selector-button:hover{
  background: #764ba2;
  transform: translateY(-2px);
}
/* æ¶‚é¸¦åŒºåŸŸ */
.doodle-box{
  display: flex;
  gap: 15px;
  align-items: flex-start;
}
#canvas{
  background: #fff;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  cursor: crosshair;
}
.doodle-controls{
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.preview-img,
.preview-audio{
  max-width: 100%;
  margin-top: 10px;
  border-radius: 8px;
}
/* è¡¨æƒ… */
.emoji{
  width: 26px;
  height: 26px;
  cursor: pointer;
  transition: transform .2s;
}
.emoji:hover{
  transform: scale(1.2);
}
/* ---------- ç¾åŒ–ç»“æŸ ---------- */
</style>
</head>
<body>

<!-- å·¦ä¾§ä¿¡æ¯é¢æ¿ -->
<aside class="info-panel">
  <h2>ğŸŒŸ æˆ‘çš„æ—¥è®°</h2>

  <div class="form-group">
    <label>æ—¶é—´</label>
    <input type="datetime-local" id="time">
  </div>

  <div class="form-group">
    <label>å¤©æ°”</label>
    <select id="weather">
      <option>â˜€ï¸ æ™´</option><option>â›… å¤šäº‘</option><option>ğŸŒ§ï¸ é›¨</option><option>ğŸŒ¨ï¸ é›ª</option>
    </select>
  </div>

  <div class="form-group">
    <label>å¿ƒæƒ…</label>
    <select id="mood">
      <option>ğŸ˜Š å¼€å¿ƒ</option><option>ğŸ˜” éš¾è¿‡</option><option>ğŸ˜  ç”Ÿæ°”</option><option>ğŸ˜Œ å¹³é™</option>
    </select>
  </div>

  <div class="form-group">
    <label>åœ°ç‚¹</label>
    <input type="text" id="location" placeholder="è¯·è¾“å…¥åœ°ç‚¹">
  </div>
</aside>

<!-- å³ä¾§ç¼–è¾‘åŒº -->
<section class="editor-wrap">
  <div id="diary-content" contenteditable="true"></div>

  <div class="toolbar">
    <button onclick="insertEmoji('ğŸ˜Š')">ğŸ˜Š</button>
    <button onclick="insertEmoji('ğŸ˜¢')">ğŸ˜¢</button>
    <button onclick="insertEmoji('â¤ï¸')">â¤ï¸</button>
    <input type="file" id="imageInput" accept="image/*" onchange="insertImage()">
    <input type="file" id="audioInput" accept="audio/*" onchange="insertAudio()">
  </div>

  <div class="doodle-box">
    <canvas id="canvas" width="380" height="220"></canvas>
    <div class="doodle-controls">
      <button onclick="undoDoodle()">â†¶ æ’¤å›ä¸Šä¸€ç¬”</button>
      <button onclick="insertDoodle()">æ’å…¥æ¶‚é¸¦</button>
    </div>
  </div>
</section>

<script>
/* ---------------- åŸºç¡€åŠŸèƒ½ ---------------- */
function insertEmoji(emoji) {
  document.getElementById('diary-content').innerHTML += emoji;
}
function insertImage() {
  const file = document.getElementById('imageInput').files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    document.getElementById('diary-content').innerHTML += `<br>< img src="${e.target.result}" class="preview-img"><br>`;
  };
  reader.readAsDataURL(file);
}
function insertAudio() {
  const file = document.getElementById('audioInput').files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    document.getElementById('diary-content').innerHTML += `<br><audio controls class="preview-audio"><source src="${e.target.result}" type="${file.type}"></audio><br>`;
  };
  reader.readAsDataURL(file);
}
/* ---------------- æ¶‚é¸¦ï¼šæ”¯æŒæ’¤å› ---------------- */
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let drawing = false;
let history = []; // ä¿å­˜æ¯ä¸€ç¬”çš„ imageData
function saveState() {
  history.push(ctx.getImageData(0, 0, canvas.width, canvas.height));
}
function undoDoodle() {
  if (history.length === 0) return;
  ctx.putImageData(history.pop(), 0, 0);
}
canvas.addEventListener('mousedown', e => {
  drawing = true;
  saveState(); // å¼€å§‹æ–°çš„ä¸€ç¬”å‰ä¿å­˜çŠ¶æ€
});
canvas.addEventListener('mouseup', () => drawing = false);
canvas.addEventListener('mouseout', () => drawing = false);
canvas.addEventListener('mousemove', e => {
  if (!drawing) return;
  ctx.fillStyle = 'black';
  ctx.beginPath();
  ctx.arc(e.offsetX, e.offsetY, 2.2, 0, Math.PI * 2);
  ctx.fill();
});
function insertDoodle() {
  document.getElementById('diary-content').innerHTML += `<br>< img src="${canvas.toDataURL()}" class="preview-img"><br>`;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  history = []; // æ¸…ç©ºå†å²
}
/* ---------------- åˆå§‹åŒ–æ—¶é—´ ---------------- */
window.onload = () => {
  const local = new Date().toISOString().slice(0, 16);
  document.getElementById('time').value = local;
};
</script>
</body>
</html>